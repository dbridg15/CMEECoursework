# print("Vectorized Stochastic Ricker takes:")
rm(list=ls())
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (pop in 1:length(p0)) #loop through the populations
{
for (yr in 2:numyears) #for each pop, loop through the years
{
N[yr,pop]<-N[yr-1,pop]*exp(r*(1-N[yr-1,pop]/K)+rnorm(1,0,sigma))
}
}
return(N)
}
rm(list=ls())
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (pop in 1:length(p0)) #loop through the populations
{
for (yr in 2:numyears) #for each pop, loop through the years
{
N[yr,pop]<-N[yr-1,pop]*exp(r*(1-N[yr-1,pop]/K)+rnorm(1,0,sigma))
}
}
return(N)
}
system.time(stochrick())
plot(stochrick())
plot(stochrick(), type = 'l')
plot(Ricker(generations = 10), type = "l")
Ricker <- function(N0 = 1, r = 1, K = 10, generations = 50){
# runs a simulation of the Ricker model
# returns a vector of legnth generations
N <- rep(NA, generations)  # created a vector of NA
N[1] <- N0
for(t in 2:generations){
N[t] <- N[t -1] * exp(r*(1.0-(N[t-1]/K)))
}
return(N)
}
plot(Ricker(generations = 10), type = "l")
require(dplyr)
attach(iris)
dplyr::tbl_df(iris)
dplyr::glimpse(iris)
dplyr::view(iris)
dplyr::View(iris)
utils::View(iris)
dplyr::filter(iris)
dplyr::slice(iris)
plot(stochrick(), type = 'l')
plot(stochrick(), type = 'l')
plot(Ricker(generations = 10), type = "l")
plot(Ricker(), type = "l")
plot(Ricker(generations = 5), type = "l")
plot(Ricker(generations = 10), type = "l")
plot(Ricker(2,2,100,50), type = "l")
plot(stochrick(), type = 'l')
print(stochrick())
print(Ricker())
print(stochrick()[,1])
plot(stochrick()[,1])
plot(stochrick()[,1], 'l')
plot(stochrick()[,1], type ='l')
plot(stochrick()[1,], type ='l')
print(Ricker())
plot(Ricker())
print(stochrick()[,1,])
print(stochrick()[,1]
)
?matrix
?runif
runif(1000,.5,1.5)
print(N[1,])
print(stochrick()[1,])
print(stochrick()[2,])
print(stochrick()[3,])
?dplyr
print(stochrick()[1,])
print(stochrick()[,1])
?apply
plot(stochrick()[1,], type ='l')
print(stochrick()[,1])
plot(stochrick()[,1])
plot(stochrick()[,1], type = 'l')
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,pop]*exp(r*(1-N[yr-1,]/K)+rnorm(1,0,sigma))
}
return(N)
}
system.time(stochrick())
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (pop in 1:length(p0)) #loop through the populations
{
for (yr in 2:numyears) #for each pop, loop through the years
{
N[yr,pop]<-N[yr-1,pop]*exp(r*(1-N[yr-1,pop]/K)+rnorm(1,0,sigma))
}
}
return(N)
}
system.time(stochrick())
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/K)+rnorm(1,0,sigma))
}
return(N)
}
system.time(stochrick())
plot(stochrick()[,1], type = 'l')
plot(stochrick()[,40], type = 'l')
runif
?runif
?sample
sample(1000, 50)
?rnorm
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(1, 2, 2)
rnorm(10, 2, 2)
rnorm(15, 2, 2)
?res2
print(system.time(res2 <- stochrick()))
print(system.time(res2<-stochrickvect()))
range(1:100)
range(1,100)
?range
vector(length = 100)
1:100
?seq
seq(0,1,0.1)
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l')
}
}
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rnorm(1,0,sigma))
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l')
}
}
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', title(paste("r: ", r, " k: ", k, " sigma: ", sigma)))
}
}
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', title(paste("r: ", r, " k: ", k, " sigma: ", sigma)))
}
}
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', title(paste("r: ", r, " k: ", k, " sigma: ", sigma)))
}
}
paste("r: ", r, " k: ", k, " sigma: ", sigma)
for(r in rnorm(1, 2, 2)){
for(k in 1:100){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', main = paste("r: ", r, " k: ", k, " sigma: ", sigma))
}
}
?rnorm
rnorm(1, 2, 2)
rnorm(10, 2, 2)
for(r in rnorm(10, 2, 2)){
for(k in seq(1,100,10)){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', main = paste("r: ", r, " k: ", k, " sigma: ", sigma))
}
}
for(r in rnorm(10, 2, 1)){
for(k in seq(1,100,10)){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', main = paste("r: ", r, " k: ", k, " sigma: ", sigma))
}
}
print("Non-Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrick()))
set.seed(1234567)
rnorm(1)
rnorm(1)
rnorm(1)
M <- matrix(runif(1000), nrow = 1000, ncol = 1000)
M
M <- matrix(runif(1000), nrow = 100, ncol = 1000)
M
m[1,]
M[1,]
rnorm(50)
rnorm(1,0,sigma)
rnorm(99,0,sigma)
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (yr in 2:numyears){ #for each pop, loop through the years
x <- rnorm(numyears-1, 0, sigma)
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+x)
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
stochrickvect()
rnorm(99, 0, 0.2)
rando < - matrix(rnorm(numyears -1)*1000, 1000, 99)
matrix(rnorm(numyears -1)*1000, 1000, 99)
numyears=100
matrix(rnorm(numyears -1)*1000, 1000, 99)
rando <- matrix(rnorm(numyears -1)*1000, 1000, 99)
rando
?rnorm
rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), 1000, 99)
rando
rando[1,]
?matrix
rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)
rando
rando[1,]
rm(list=ls())
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rando[yr,])
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
rm(list=ls())
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rando[yr-1,])
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
print("Non-Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrick()))
stochrick<-function(p0=runif(1000,.5,1.5),r=1.2,K=1,sigma=0.2,numyears=100)
{
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
for (pop in 1:length(p0)) #loop through the populations
{
for (yr in 2:numyears) #for each pop, loop through the years
{
N[yr,pop]<-N[yr-1,pop]*exp(r*(1-N[yr-1,pop]/K)+rnorm(1,0,sigma))
}
}
return(N)
}
print("Non-Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrick()))
rm(list=ls())
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rando[yr-1,])
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
# rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rnorm(1,0,sigma))  #rando[yr-1,])
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
stochrickvect <- function(p0=runif(1000,.5,1.5),r=1.2,k=1,sigma=0.2,numyears=100){
#initialize
N<-matrix(NA,numyears,length(p0))
N[1,]<-p0
# rando <- matrix(rnorm((numyears -1)*1000, 0, sigma), numyears-1, 1000)  # this actually makes it slower!!!
for (yr in 2:numyears){ #for each pop, loop through the years
N[yr,]<-N[yr-1,]*exp(r*(1-N[yr-1,]/k)+rnorm(1000,0,sigma))  #rando[yr-1,])
}
return(N)
}
print("Vectorized Stochastic Ricker takes:")
print(system.time(res2<-stochrickvect()))
rnorm(1000,0,0.2)
for(r in rnorm(10, 2, 1)){
for(k in seq(1,100,10)){
for(sigma in seq(0,1,0.1))
plot(stochrickvect(r =r, k = k, sigma = sigma)[,1], type = 'l', main = paste("r: ", r, " k: ", k, " sigma: ", sigma))
}
}
plot(stochrickvect(), type = 'l')
plot(stochrickvect()[,1], type = 'l')
stochrickvect()
plot(stochrickvect()[,1], type = 'l')
rnorm(10000)
plot(rnorm(1000), rnorm(1000))
plot(rnorm(1000), rnorm(1000))
plot(rnorm(1000), rnorm(1000))
hist(rnorm(1000))
barplot(rnorm(1000))
dev.list
wd
wd()
getwd()
setwd('cmeecoursework/Week3/Code/')
MyDF <- read.csv('../Data/EcolArchives-E089-51-D1.csv')
dim(MyDF)
head(MyDF)
plot(Predator.mass,prey.mass, data = MyDF)
plot(MyDF$Predator.mass, MyDF$prey.mass, data)
plot(MyDF$Predator.mass, MyDF$prey.mass)
plot(MyDF$Predator.mass, MyDF$Prey.mass)
plot(log(MyDF$Predator.mass), log(MyDF$Prey.mass)
plot(log(MyDF$Predator.mass), log(MyDF$Prey.mass)
plot(log(MyDF$Predator.mass), log(MyDF$Prey.mass))
plot(log(MyDF$Predator.mass), log(MyDF$Prey.mass), pch = 20)
plot(log(MyDF$Predator.mass), log(MyDF$Prey.mass), pch = 20,
xlab = 'Predator Mass (kg)', ylab = 'Prey Mass (kg)')
hist(MyDF)
hist(MyDF$Predator.mass)
hist(log(MyDF$Predator.mass)
hist(log(MyDF$Predator.mass))
hist(log(MyDF$Predator.mass))
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
?hist
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', breaks = 1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink')
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink',w=1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Predator.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
hist(log(MyDF$Prey.mass), xlab = 'predator amss (kg)', ylab = 'count', col = 'lightblue', border = 'pink', w=1)
par(mfcol=c(2,1)) #initialize multi-paneled plot
par(mfg = c(1,1)) # specify which sub-plot to use first
hist(log(MyDF$Predator.mass), xlab = "Predator Mass (kg)", ylab = "Count",
col = "lightblue", border = "pink", main = 'Predator') # Add title
par(mfg = c(2,1)) # Second sub-plot
hist(log(MyDF$Prey.mass), xlab="Prey Mass (kg)",
ylab="Count", col = "lightgreen", border = "pink", main = 'prey')
dev.off()
par(mfcol=c(2,1)) #initialize multi-paneled plot
par(mfg = c(1,1)) # specify which sub-plot to use first
hist(log(MyDF$Predator.mass), xlab = "Predator Mass (kg)", ylab = "Count",
col = "lightblue", border = "pink", main = 'Predator') # Add title
par(mfg = c(2,1)) # Second sub-plot
hist(log(MyDF$Prey.mass), xlab="Prey Mass (kg)",
ylab="Count", col = "lightgreen", border = "pink", main = 'prey')
hist(log(MyDF$Predator.mass), # Predator histogram
col = rgb(1, 0, 0, 0.5), # Note 'rgb', fourth value is transparency main = "Predator-prey size Overlap")
legend('topleft',c('Predators','Prey'), # Add legend
fill=c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5))) # Define legend colors
hist(log(MyDF$Predator.mass), # Predator histogram
xlab="Body Mass (kg)", ylab="Count",
col = rgb(1, 0, 0, 0.5), # Note 'rgb', fourth value is transparency main = "Predator-prey size Overlap")
hist(log(MyDF$Prey.mass), col = rgb(0, 0, 1, 0.5), add = T) # Plot prey
legend('topleft',c('Predators','Prey'), # Add legend
fill=c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5))) # Define legend colors
)
dev.off()
hist(log(MyDF$Predator.mass), # Predator histogram
xlab="Body Mass (kg)", ylab="Count",
col = rgb(1, 0, 0, 0.5), # Note 'rgb', fourth value is transparency
main = "Predator-prey size Overlap")
hist(log(MyDF$Prey.mass), col = rgb(0, 0, 1, 0.5), add = T) # Plot prey
legend('topleft',c('Predators','Prey'), # Add legend
fill=c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5))) # Define legend colors
boxplot(log(MyDF$Predator.mass) ∼ MyDF$Location, # Why the tilde?
xlab = "Location", ylab = "Predator Mass",
main = "Predator massby location")
boxplot(log(MyDF$Predator.mass) ∼ MyDF$Location, # Why the tilde?
xlab = "Location", ylab = "Predator Mass",
main = "Predator massby location")
boxplot(log(MyDF$Predator.mass) ∼ MyDF$Location,
xlab = "Location", ylab = "Predator Mass",
main = "Predator mass by location")
main = "Predator mass by location"
boxplot(log(MyDF$Predator.mass) ∼ MyDF$Location,
main = "Predator mass by location"
boxplot(log(MyDF$Predator.mass) ∼ MyDF$Location,)
boxplot(log(MyDF$Predator.mass) ~ MyDF$Location)
boxplot(log(MyDF$Predator.mass) ~ MyDF$Type.of.feeding.interaction)
par(fig=c(0,0.8,0,0.8))
plot(log(MyDF$Predator.mass),log(MyDF$Prey.mass), xlab = "Predator Mass (kg)", ylab = "Prey Mass (kg)")
par(fig=c(0,0.8,0.55,1), new=TRUE)
boxplot(log(MyDF$Predator.mass), horizontal=TRUE, axes=FALSE)
par(fig=c(0.65,1,0,0.8),new=TRUE)
boxplot(log(MyDF$Prey.mass), axes=FALSE)
mtext("Fancy Predator-prey scatterplot", side=3, outer=TRUE, line=-3)
library(lattice)
densityplot(~log(predator.mass) | Type.of.feeding.interaction, data = MyDF)
densityplot(~log(Predator.mass) | Type.of.feeding.interaction, data = MyDF)
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count'
col = rgb(1, 0, 0, 0.5),
main "Predator-Prey Size Overlap")
hist(log(MyDF$Predator.mass),
col = rgb(0, 0, 1, 0.5)
add = T)
legend('topleft', c('Predators', 'Prey')
fill = c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5)))
dev.off()
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count'
col = rgb(1, 0, 0, 0.5),
main "Predator-Prey Size Overlap")
dev.off()
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count',
col = rgb(1, 0, 0, 0.5),
main "Predator-Prey Size Overlap")
dev.off()
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count',
col = rgb(1, 0, 0, 0.5),
main = "Predator-Prey Size Overlap")
hist(log(MyDF$Predator.mass),
col = rgb(0, 0, 1, 0.5)
add = T)
dev.off()
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count',
col = rgb(1, 0, 0, 0.5),
main = "Predator-Prey Size Overlap")
hist(log(MyDF$Predator.mass),
col = rgb(0, 0, 1, 0.5),
add = T)
legend('topleft', c('Predators', 'Prey')
fill = c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5)))
dev.off()
pdf("../Results/Pred_Prey_Overlay.pdf", 11.7, 8.3)
hist(log(MyDF$Prey.mass),
xlab = 'Body Mass (kg)', ylab = 'count',
col = rgb(1, 0, 0, 0.5),
main = "Predator-Prey Size Overlap")
hist(log(MyDF$Predator.mass),
col = rgb(0, 0, 1, 0.5),
add = T)
legend('topleft', c('Predators', 'Prey'),
fill = c(rgb(1, 0, 0, 0.5), rgb(0, 0, 1, 0.5)))
dev.off()
